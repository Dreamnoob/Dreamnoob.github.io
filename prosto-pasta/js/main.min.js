toggleHeaderMenu();

toggleBasket();

mobileHeight();

initAccordion();

initTextarea();

faqAdaptive();

toggleCookiesPopup();

window.addEventListener('resize', () => {
    mobileHeight();
    faqAdaptive();
});


function toggleHeaderMenu() {
    const headerBurger = document.querySelector(".header-burger");
    const headerNav = document.querySelector(".header-nav");

    headerBurger.addEventListener('click', function () {
        this.classList.toggle('active');
        headerNav.classList.toggle('active');
    });
}


function toggleBasket() {
    const headerBasketBtn = document.querySelector(".header-basket");
    const basketCloseBtn = document.querySelector(".basket-close");
    const basket = document.querySelector(".basket");

    headerBasketBtn.addEventListener('click', function () {
        basket.classList.add('active');
    });

    basketCloseBtn.addEventListener('click', function () {
        basket.classList.remove('active');
    });
}

function mobileHeight() {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}


function initAccordion() {
    const questions = document.querySelectorAll(".faq-question");

    if (questions.length !== 0) {
        questions.forEach(function (item) {
            item.addEventListener("click", function () {
                if (this.classList.contains("active")) {
                    this.classList.remove("active");
                    this.nextElementSibling.style.maxHeight = "";
                    this.nextElementSibling.classList.remove("active");
                } else {
                    this.classList.add("active");
                    this.nextElementSibling.style.maxHeight = this.nextElementSibling.scrollHeight + "px";
                    this.nextElementSibling.classList.add("active");
                }
            });
        });
    }
}

function initTextarea() {
    const textarea = document.querySelector(".field-textarea");

    if (textarea) {
        textarea.addEventListener('input', function () {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        });
    }
}

function faqAdaptive() {
    const form = document.querySelector(".faq-form");
    const blockOne = document.querySelector(".faq-one");
    const blockTwo = document.querySelector(".faq-two");

    if (form && blockOne && blockTwo) {
        if (window.innerWidth >= 1024 && !form.classList.contains("adaptive")) {
            blockTwo.appendChild(form);
            form.classList.add("adaptive");
        } else if (window.innerWidth < 1024 && form.classList.contains("adaptive")) {
            blockOne.appendChild(form);
            form.classList.remove("adaptive");
        }
    }
}

function toggleCookiesPopup() {
    function setCookie(name, value) {
        document.cookie = encodeURIComponent(name) + "=" + encodeURIComponent(value);
    }

    function getCookie(name) {
        let matches = document.cookie.match(new RegExp(
            "(?:^|; )" + name.replace(/([.$?*|{}()\[\]\\\/+^])/g, '\\$1') + "=([^;]*)"
        ));
        return matches ? decodeURIComponent(matches[1]) : undefined;
    }

    if (!getCookie('policyAgree')) {
        const popup = document.querySelector(".cookies-popup");
        const btn = document.querySelector(".cookies-popup-btn");

        setTimeout(() => {
            popup.classList.add('active');
        }, 3000);

        btn.addEventListener("click", () => {
            popup.classList.remove('active');
            setCookie('policyAgree', 'true');
        });
    }
}